# note that some apks can't be recompiled with older versions of apktool
# use the latest.

# to disassemble apk to smali 
apktool d filename.apk

# to rebuild apk
apktool b filename -o filename-mod.apk

# to generate keystore
keytool -genkey -v -keystore hacketh.keystore -alias takaya -keyalg RSA -keysize 2048 -validity 10000

# to sign apk
jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore hacketh.keystore target.apk takaya

# to view existing images in android studio
~/Android/Sdk/emulator -list-avds

# to start emulator via cli
~/Android/Sdk/emulator @Nexus_4_API_23

# to install root manager (SuperSU) on android emulator

#1. get the right binaries and the SuperSU.apk
wget https://github.com/0xFireball/root_avd/tree/master/SuperSU

#2. run the emulator with the following arguments
/home/takaya/Android/Sdk/emulator/emulator @Nexus_6_API_25 -writable-system -selinux permissive -qemu -enable-kvm

#3. remount the emulator
adb root && adb remount

#4. install SuperSU.apk, push the `su` binary and chmod
adb install SuperSU.apk && adb push su /system/xbin/su && \
adb shell --chmod 755 /system/xbin/su

#5. set SELinux to permissive, install `su` and run it as daemon
adb shell setenforce 0 && adb shell su --install && adb shell su --daemon&

#6. update the binary with `normal mode` on the apk

#7. make aliases to start the emulator with the second command

#8. also make an alias for when the emulator is running
adb root > /dev/null 2>&1 && adb shell su --daemon > /dev/null 2>&1 &

# the root is not persistent after each boot, which is why aliases will
# help a lot.
# credits to https://github.com/0xFireball/root_avd

